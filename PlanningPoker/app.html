<!DOCTYPE html>
<html lang="en">

<head>
  <title>Planning Poker App</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, Helvetica, sans-serif;
    }

    .container{
      padding-left:5%;
      align-content: center;
    }
    /* Float four columns side by side */
    .column {
      float: left;
      width: 15%;
      padding: 0 10px;
    }

    /* Remove extra left and right margins, due to padding */
    .row {
      margin: 0 -5px;
    }

    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
      padding: 8px;
    }

    /* Responsive columns */
    @media screen and (max-width: 600px) {
      .column {
        width: 100%;
        display: block;
        margin-bottom: 20px;
      }
    }

    /* Style the counter cards */
    .card {
      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
      padding: 16px;
      text-align: center;
      background-color: #f1f1f1;
    }

    .number {
      font-size: 100px;
      font-family: fantasy;
      color: cadetblue;
    }
  </style>
</head>

<script src="/socket.io/socket.io.js"></script>

<script>
  var socket = io();

  function joinUserInRoom() {
    socket.emit('joinUserInRoom', document.getElementById('roomno').value, document.getElementById('name').value);
  };

  socket.on('userExists', function (data) {
    document.getElementById('error-container').innerHTML = data;
    document.getElementById('error-container').hidden = false;
  });

  socket.on('userSet', function (username, roomno) {
    document.getElementById('userDetailsDiv').hidden = true;
    document.getElementById('error-container').hidden = true;
    document.getElementById('rommLabel').innerHTML = "Room Number : " + document.getElementById('roomno').value;
    document.getElementById('welcomeUserLabel').innerHTML = "Welcome  : " + document.getElementById('name').value;
    document.getElementById('chatDiv').hidden = false;
    document.getElementById('cardDeck').hidden = false;


  });

  function sendMessage() {
    var msg = document.getElementById('message').value;
    if (msg) {
      //socket.emit('msg', { message: msg, user: user });
      socket.emit('msg', msg, document.getElementById('roomno').value, document.getElementById('name').value);
    }
  }

  socket.on('newmsg', function (message, user) {
    if (true) {
      document.getElementById('message-container').innerHTML += '<div><b>' +
        user + '</b>: ' + message + '</div>'
    }
  });
</script>

<body>
  <div class="container">
    <div id="error-container" class="alert alert-danger" hidden></div>
    <div id="userDetailsDiv" class="container">
      <label>Room number</label>
      <input id="roomno" type="text" name="roomno" value="" placeholder="Enter your room number!">
      <br /><br />
      <label>User name</label>
      <input id="name" type="text" name="name" value="" placeholder="Enter your name!">
      <br /><br />
      <button type="button" class="btn btn-primary btn-sm" name="button" onclick="joinUserInRoom()">
        Let me chat!
      </button>
    </div>
    <div id="chatDiv" hidden class="container">
      <label id="rommLabel"> Room No- </label><br />
      <label id="welcomeUserLabel"> Welcome </label><br />
      <input type="text" id="message">
      <button class="btn btn-primary btn-sm" type="button" name="button" onclick="sendMessage()">Send</button>
      <div id="message-container" class="container"></div>
    </div>
    <br />
    <div class="row">
      <div class="column">
        <div class="card">
          <div class="number">0</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">1</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">2</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">3</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">5</div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="column">
        <div class="card">
          <div class="number">8</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">13</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">21</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">34</div>
        </div>
      </div>

      <div class="column">
        <div class="card">
          <div class="number">?</div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>